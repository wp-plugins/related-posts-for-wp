jQuery(document).ready(function(a){function b(b){this.step=b,this.total_posts=0,this.ppr=null,this.req_nr=0,this.action=null,this.do_request=function(){var b=this;a.post(ajaxurl,{action:this.action,rel_amount:a("#rp4wp_related_posts_amount").val()},function(a){"more"==a?(b.req_nr++,b.do_progressbar(),b.do_request()):"done"==a?b.done():alert("Woops! Something went wrong while linking.\n\nResponse:\n\n"+a)})},this.done=function(){a("#progressbar").progressbar({value:100}),window.location=a("#rp4wp_admin_url").val()+"?page=rp4wp_install&step="+(this.step+1)},this.do_progressbar=function(){a("#progressbar").progressbar({value:this.req_nr*this.ppr/this.total_posts*100})},this.init=function(){switch(a("#progressbar").progressbar({value:!1}),this.total_posts=a("#rp4wp_total_posts").val(),this.step){case 1:this.ppr=200,this.action="rp4wp_install_save_words";break;case 2:this.ppr=5,this.action="rp4wp_install_link_posts"}this.do_request()},this.init()}var c=a(".rp4wp-step").attr("rel");1==c?b(1):2==c&&a("#rp4wp-link-now").click(function(){b(2)})});